
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../anharmonic_free_energy/">
      
      
        <link rel="next" href="../extract_forceconstants/">
      
      <link rel="icon" href="../../media/matematico_favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Phonon dispersion relations - TDEP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CDroid+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Droid Sans Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Teal" data-md-color-accent="Blue-Grey">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#short-description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TDEP" class="md-header__button md-logo" aria-label="TDEP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TDEP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Phonon dispersion relations
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../atomic_distribution/" class="md-tabs__link">
        Currently trying to fix programs
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../lineshape/" class="md-tabs__link md-tabs__link--active">
        Catastrophic programs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../extract_forceconstants/" class="md-tabs__link">
        Decent programs
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../files/" class="md-tabs__link">
      Files
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TDEP" class="md-nav__button md-logo" aria-label="TDEP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    TDEP
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Currently trying to fix programs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Currently trying to fix programs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../atomic_distribution/" class="md-nav__link">
        Atomic distribution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Catastrophic programs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Catastrophic programs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lineshape/" class="md-nav__link">
        Lineshape
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../thermal_conductivity/" class="md-nav__link">
        Thermal conductivity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../anharmonic_free_energy/" class="md-nav__link">
        Anharmonic free energy
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Phonon dispersion relations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Phonon dispersion relations
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#short-description" class="md-nav__link">
    Short description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-options" class="md-nav__link">
    Command line options:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-this-code-produce" class="md-nav__link">
    What does this code produce?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equations-of-motion-in-a-harmonic-crystal" class="md-nav__link">
    Equations of motion in a harmonic crystal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#long-ranged-interactions-in-polar-materials" class="md-nav__link">
    Long-ranged interactions in polar materials
  </a>
  
    <nav class="md-nav" aria-label="Long-ranged interactions in polar materials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#separation-approach-1" class="md-nav__link">
    Separation approach 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separation-approach-2" class="md-nav__link">
    Separation approach 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-space-approach" class="md-nav__link">
    Mixed-space approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-dispersive-properties" class="md-nav__link">
    Other dispersive properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#density-of-states" class="md-nav__link">
    Density of states
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    Input files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output files
  </a>
  
    <nav class="md-nav" aria-label="Output files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outfiledispersion_relationshdf5" class="md-nav__link">
    outfile.dispersion_relations.hdf5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilephonon_doshdf5" class="md-nav__link">
    'outfile.phonon_dos.hdf5'
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfiledispersion_relations" class="md-nav__link">
    outfile.dispersion_relations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilegroup_velocities" class="md-nav__link">
    outfile.group_velocities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilemode_gruneisen_parameters" class="md-nav__link">
    outfile.mode_gruneisen_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilephonon_dos" class="md-nav__link">
    outfile.phonon_dos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilefree_energy" class="md-nav__link">
     outfile.free_energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilegrid_dispersionshdf5" class="md-nav__link">
    outfile.grid_dispersions.hdf5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Decent programs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Decent programs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../extract_forceconstants/" class="md-nav__link">
        Extract forceconstants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pack_simulation/" class="md-nav__link">
        Pack simulation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generate_structure/" class="md-nav__link">
        Generate structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../crystal_structure_info/" class="md-nav__link">
        Crystal structure info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../canonical_configuration/" class="md-nav__link">
        Canonical configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../samples_from_md/" class="md-nav__link">
        Samples from MD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../refine_structure/" class="md-nav__link">
        Refine structure
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../files/" class="md-nav__link">
        Files
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#short-description" class="md-nav__link">
    Short description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-options" class="md-nav__link">
    Command line options:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-does-this-code-produce" class="md-nav__link">
    What does this code produce?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#equations-of-motion-in-a-harmonic-crystal" class="md-nav__link">
    Equations of motion in a harmonic crystal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#long-ranged-interactions-in-polar-materials" class="md-nav__link">
    Long-ranged interactions in polar materials
  </a>
  
    <nav class="md-nav" aria-label="Long-ranged interactions in polar materials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#separation-approach-1" class="md-nav__link">
    Separation approach 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separation-approach-2" class="md-nav__link">
    Separation approach 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mixed-space-approach" class="md-nav__link">
    Mixed-space approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-dispersive-properties" class="md-nav__link">
    Other dispersive properties
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#density-of-states" class="md-nav__link">
    Density of states
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    Input files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output files
  </a>
  
    <nav class="md-nav" aria-label="Output files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outfiledispersion_relationshdf5" class="md-nav__link">
    outfile.dispersion_relations.hdf5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilephonon_doshdf5" class="md-nav__link">
    'outfile.phonon_dos.hdf5'
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfiledispersion_relations" class="md-nav__link">
    outfile.dispersion_relations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilegroup_velocities" class="md-nav__link">
    outfile.group_velocities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilemode_gruneisen_parameters" class="md-nav__link">
    outfile.mode_gruneisen_parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilephonon_dos" class="md-nav__link">
    outfile.phonon_dos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilefree_energy" class="md-nav__link">
     outfile.free_energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outfilegrid_dispersionshdf5" class="md-nav__link">
    outfile.grid_dispersions.hdf5
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Phonon dispersion relations</h1>

<h3 id="short-description">Short description</h3>
<p>Calculate phonon dispersions and related quantities. Per default, only the dispersions along a default path will be calculated. Options are available for calculating mode gruneisen parameters, phonon density of states projected in a variety of ways, thermodynamic quantities and pure data dumps.</p>
<h3 id="command-line-options">Command line options:</h3>
<p>Optional switches:</p>
<ul>
<li>
<p><code>--unit value</code>, value in: <code>thz,mev,icm</code><br />
    default value thz<br />
    Choose the output unit. The options are terahertz (in frequency, not angular frequency), inverse cm or meV.</p>
</li>
<li>
<p><code>--nq_on_path value</code>, <code>-nq value</code><br />
    default value 100<br />
    Number of q-points between each high symmetry point</p>
</li>
<li>
<p><code>--readpath</code>, <code>-rp</code><br />
    default value .false.<br />
    Read the q-point path from <code>infile.qpoints_dispersion</code>. Use <a href="../crystal_structure_info/">crystal structure into</a> to generate an example.</p>
</li>
<li>
<p><code>--dos</code><br />
    default value .false.<br />
    Calculate the phonon DOS</p>
</li>
<li>
<p><code>--qpoint_grid value#1 value#2 value#3</code>, <code>-qg value#1 value#2 value#3</code><br />
    default value 26 26 26<br />
    Density of q-point mesh for Brillouin zone integrations.</p>
</li>
<li>
<p><code>--meshtype value</code>, value in: <code>1,2,3,4</code><br />
    default value 1<br />
    Type of q-point mesh. 1 Is a Monkhorst-Pack mesh, 2 an FFT mesh and 3 my fancy wedge-based mesh with approximately the same density the grid-based meshes. 4 build the commensurate mesh of an approximately cubic supercell.</p>
</li>
<li>
<p><code>--sigma value</code><br />
    default value 1.0<br />
    Global scaling factor for Gaussian/adaptive Gaussian smearing. The default is determined procedurally, and scaled by this number.</p>
</li>
<li>
<p><code>--readqmesh</code><br />
    default value .false.<br />
    Read the q-point mesh from file. To generate a q-mesh file, see the genkpoints utility.</p>
</li>
<li>
<p><code>--integrationtype value</code>, <code>-it value</code>, value in: <code>1,2,3</code><br />
    default value 2<br />
    Type of integration for the phonon DOS. 1 is Gaussian, 2 adaptive Gaussian and 3 Tetrahedron.</p>
</li>
<li>
<p><code>--dospoints value</code><br />
    default value 400<br />
    Number of points on the frequency axis of the phonon dos.</p>
</li>
<li>
<p><code>--temperature value</code><br />
    default value -1<br />
    Evaluate thermodynamic phonon properties at a single temperature.</p>
</li>
<li>
<p><code>--temperature_range value#1 value#2 value#3</code><br />
    default value -1 -1 -1<br />
    Evaluate thermodynamic phonon properties for a series of temperatures, specify min, max and the number of points.</p>
</li>
<li>
<p><code>--gruneisen</code><br />
    default value .false.<br />
    Use third order force constants to calculate mode Gruneisen parameters.</p>
</li>
<li>
<p><code>--dumpgrid</code><br />
    default value .false.<br />
    Write files with q-vectors, frequencies, eigenvectors and group velocities for a grid.</p>
</li>
<li>
<p><code>--pdf</code>, <code>-p</code><br />
    default value .false.<br />
    Produce gnuplot_pdf output file for printing to pdf.</p>
</li>
<li>
<p><code>--help</code>, <code>-h</code><br />
    Print this help message</p>
</li>
<li>
<p><code>--version</code>, <code>-v</code><br />
    Print version</p>
</li>
</ul>
<h3 id="examples">Examples</h3>
<p><code>phonon_dispersion_relations</code> </p>
<p><code>phonon_dispersion_relations --dos --qpoint_grid 24 24 24</code> </p>
<h3 id="what-does-this-code-produce">What does this code produce?</h3>
<p>This code calculates phonon dispersion relations, usually presented like this:</p>
<p><center><img src="/media/pbte_phonon_dispersions.png" width="600" /></center></p>
<p>Where the color of the line indicates the projection onto species. The same data can also be presented as a density of states, like this:</p>
<p><center><img src="/media/pbte_phonon_dos.png" width="500" /></center></p>
<p>By default, minimal input is needed, but many options to tailor the output exist.</p>
<h3 id="equations-of-motion-in-a-harmonic-crystal">Equations of motion in a harmonic crystal</h3>
<p>As detailed in <a href="../extract_forceconstants/">extract forceconstants</a> we have mapped the Born-Oppenheimer to an effective potential. A model Hamiltonian truncated at the second order (a harmonic Hamiltonian) is given by<sup id="fnref:Born1998"><a class="footnote-ref" href="#fn:Born1998">1</a></sup></p>
<div class="arithmatex">\[
\begin{equation}
\hat H=\sum_{\kappa} \frac{\mathbf{p}_{\kappa}^2}{2m_{\kappa}} + \frac{1}{2} \sum_{\kappa\lambda}\sum_{\alpha\beta}  \Phi_{\kappa\lambda}^{\alpha\beta} u^{\alpha}_{\kappa} u^{\beta}_{\lambda}\,
\end{equation}
\]</div>
<p>Where <span class="arithmatex">\(\kappa,\lambda\)</span> are indices to atoms, <span class="arithmatex">\(\alpha,\beta\)</span> Cartesian indices and <span class="arithmatex">\(\mathbf{u}\)</span> a displacement from equilibrium positions. To clarify, the instantaneous position of an atom is given by</p>
<div class="arithmatex">\[
\begin{equation}
\mathbf{r}_{\kappa} = \mathbf{R}_{\mu} + \boldsymbol{\tau}_{i} + \mathbf{u}
\end{equation}
\]</div>
<p>such that <span class="arithmatex">\(\mathbf{R} +\boldsymbol{\tau}\)</span> denote the equilibrium position of the atom. The lattice vector <span class="arithmatex">\(\mathbf{R}\)</span> locate the unit cell, <span class="arithmatex">\(\boldsymbol{\tau}\)</span> locate the atom in the unit cell, and <span class="arithmatex">\(\mathbf{u}\)</span> how far the atom has moved from the reference positions. Ignoring surface effects, we can write the equations of motion:</p>
<div class="arithmatex">\[
\begin{equation}
\ddot{\mathbf{u}}_{\mu i} m_{\mu i} =
-\sum_{\nu j} \mathbf{\Phi}_{\mu i,\nu j}\mathbf{u}_{\nu j} \,.
\end{equation}
\]</div>
<p>Here we expanded the atom index <span class="arithmatex">\(\kappa\)</span> to the double index indicating cell <span class="arithmatex">\(\mu\)</span> and position <span class="arithmatex">\(i\)</span>. Since we deal with infinite crystals with periodic boundary conditions, the equations of motion will not depend on cell index <span class="arithmatex">\(\mu\)</span>, and that index can be dropped.</p>
<div class="arithmatex">\[
\begin{equation}\label{eq:eqmotion1}
\ddot{\mathbf{u}}_{i} m_{i} =
-\sum_{\nu j} \mathbf{\Phi}_{\mu i,\nu j}\mathbf{u}_{\nu j}.
\end{equation}
\]</div>
<p>I prefer a truncated notation:</p>
<div class="arithmatex">\[
\begin{equation}
\ddot{\mathbf{u}}_{i} m_{i} =
-\sum_{\mathbf{R}} \mathbf{\Phi}_{ij}\left( \mathbf{R} \right)\mathbf{u}_{j}.
\end{equation}
\]</div>
<p>Where <span class="arithmatex">\(\mathbf{R}\)</span> implies the cell index corresponding to atom <span class="arithmatex">\(j\)</span>. To solve these equations of motion, we can use a plane-wave ansatz:</p>
<div class="arithmatex">\[
\begin{equation}
\mathbf{u}_{i}=\frac{1}{\sqrt{m_i}} \sum_{\mathbf{q}} A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \left(\mathbf{q} \cdot \mathbf{R} - \omega t \right) }.
\end{equation}
\]</div>
<p>Here the displacements are expressed as a sum of plane waves, or normal modes, each with wave vector <span class="arithmatex">\(\mathbf{q}\)</span> and frequency <span class="arithmatex">\(\omega\)</span>. <span class="arithmatex">\(\boldsymbol{\epsilon}\)</span> is a polarisation vector, and <span class="arithmatex">\(A_{\mathbf{q}}\)</span> the normal mode amplitude. Substituting this into <span class="arithmatex">\(\eqref{eq:eqmotion1}\)</span> and exploiting the orthogonality of planes waves gives,</p>
<div class="arithmatex">\[
\begin{split}
\sqrt{m_i}\sum_{\mathbf{q}} \omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \left(\mathbf{q} \cdot \mathbf{R}_i - \omega t \right) }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}}
\frac{A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}}{\sqrt{m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \left(\mathbf{q} \cdot \mathbf{R}_j - \omega t \right) } \\
%
%
\sum_{\mathbf{q}} \omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \mathbf{q} \cdot \mathbf{R}_i }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}}
\frac{A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}}{\sqrt{m_i m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \mathbf{q} \cdot \mathbf{R}_j } \\
%
%
\sum_{\mathbf{q}'} \omega^2 A_{\mathbf{q}'} \boldsymbol{\epsilon}_{\mathbf{q}'}^{i} e^{ i \mathbf{q}' \cdot \mathbf{R}_i }
e^{ -i \mathbf{q} \cdot \mathbf{R}_i }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}'}
\frac{A_{\mathbf{q}'} \boldsymbol{\epsilon}_{\mathbf{q}'}^{i}}{\sqrt{m_i m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \mathbf{q}' \cdot \mathbf{R}_j }
e^{ -i \mathbf{q} \cdot \mathbf{R}_i } \\
%
%
\omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}
= &amp;
A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}
\sum_{\mathbf{R}}
\frac{\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)}{\sqrt{m_i m_j}}
e^{ i \mathbf{q} \cdot \mathbf{R}_j } \\
%
%
\omega^2_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}= &amp; \mathbf{\Phi}(\mathbf{q}) \boldsymbol{\epsilon}_{\mathbf{q}}\,,
\end{split}
\]</div>
<p>where the periodic boundary conditions limit the choices of <span class="arithmatex">\(\mathbf{q}\)</span> to a wave vector <span class="arithmatex">\(\mathbf{q}\)</span> in the first Brillouin zone. The dynamical matrix <span class="arithmatex">\(\mathbf{\Phi}(\mathbf{q})\)</span> is given by</p>
<div class="arithmatex">\[
\begin{equation}
\mathbf{\Phi}(\mathbf{q})=
\begin{pmatrix}
\mathbf{\Phi}_{11}(\mathbf{q}) &amp; \cdots &amp; \mathbf{\Phi}_{N 1}(\mathbf{q}) \\
\vdots &amp; \ddots &amp; \vdots \\
\mathbf{\Phi}_{1N}(\mathbf{q}) &amp; \cdots &amp; \mathbf{\Phi}_{N N}(\mathbf{q}) \\
\end{pmatrix}
\end{equation}
\]</div>
<p>This is the Fourier transform of the mass-weighted force constant matrix, where each <span class="arithmatex">\(3 \times 3\)</span> submatrix of the full <span class="arithmatex">\(3N \times 3N\)</span> is given by</p>
<div class="arithmatex">\[
\begin{equation}
\mathbf{\Phi}_{ij}(\mathbf{q})=
\sum_{\mathbf{R}}
\frac{ \mathbf{\Phi}_{ij}(\mathbf{R}) }{\sqrt{m_i m_j}}
e^{i\mathbf{q}\cdot \mathbf{R}} \,.
\end{equation}
\]</div>
<p>The eigenvalues <span class="arithmatex">\(\omega^2_{\mathbf{q}s}\)</span> and eigenvectors <span class="arithmatex">\(\boldsymbol{\epsilon}_{\mathbf{q}s}\)</span> of the dynamical matrix denote the possible normal mode frequencies and polarizations of the system. The eigenvalues have the same periodicity as the reciprocal lattice; hence it is convenient to limit the solution to all vectors <span class="arithmatex">\(\mathbf{q}\)</span> in the first Brillouin zone. It is also worth defining the partial derivatives of the dynamical matrix:</p>
<div class="arithmatex">\[
\begin{align}
\frac{\partial \mathbf{\Phi}_{ij}(\mathbf{q})}{\partial q_\alpha}
 &amp; =
\sum_{\mathbf{R}}
iR_\alpha
\frac{ \mathbf{\Phi}_{ij}(\mathbf{R}) }{\sqrt{m_i m_j}}
e^{i\mathbf{q}\cdot \mathbf{R}}. \\
\frac{\partial^2 \mathbf{\Phi}_{ij}(\mathbf{q})}{\partial q_\alpha \partial q_{\beta}}
 &amp; =
-\sum_{\mathbf{R}}
R_{\alpha} R_{\beta}
\frac{ \mathbf{\Phi}_{ij}(\mathbf{R}) }{\sqrt{m_i m_j}}
e^{i\mathbf{q}\cdot \mathbf{R}}.
\end{align}
\]</div>
<p>By calculating the eigenvalues and eigenvectors of the dynamical matrix over the Brillouin zone, all thermodynamic quantities involving the atomic motions can be determined, as far as the harmonic approximation is valid. If you are curious where the amplitudes of the normal modes disappeared, see <a href="../canonical_configuration/">canonical configuration</a>.</p>
<h3 id="long-ranged-interactions-in-polar-materials">Long-ranged interactions in polar materials</h3>
<p>When determining the dynamical matrix, the sum over lattice vectors <span class="arithmatex">\(\mathbf{R}\)</span> should in principle be carried out over all pairs. In practice, we assume that the interactions are zero beyond some cutoff (see <a href="../extract_forceconstants/">extract forceconstants</a> option <code>-rc2</code>), and truncate the sum. This is not a valid approach when dealing with polar material where the induced dipole-dipole interactions are essentially infinite-ranged. See for example Gonze &amp; Lee.<sup id="fnref:Gonze1994"><a class="footnote-ref" href="#fn:Gonze1994">5</a></sup> <sup id="fnref:Gonze1997"><a class="footnote-ref" href="#fn:Gonze1997">6</a></sup> When dealing with these long-ranged electrostatics we start by defining the Born effective charge tensor:</p>
<div class="arithmatex">\[
Z_{i}^{\alpha\beta} = \frac{\partial^2 U}{\partial \varepsilon^{\alpha} \partial u_{i}^{\beta}}
\]</div>
<p>That is the mixed derivative of the energy with respect to electric field <span class="arithmatex">\(\varepsilon\)</span> and displacement <span class="arithmatex">\(\mathbf{u}\)</span>. Displacing an atom from its equilibrium position induces a dipole, given by</p>
<div class="arithmatex">\[
\mathbf{d}_{i} = \mathbf{Z}_{i}\mathbf{u}_{i}
\]</div>
<p>The pairwise dipole-dipole interactions can be expressed as forceconstants:</p>
<div class="arithmatex">\[
\begin{align}
\Phi^{\textrm{dd}}|^{\alpha\beta}_{ij} &amp; = \sum_{\gamma\delta} Z_{i}^{\alpha\gamma}Z_{j}^{\beta\delta} \widetilde{\Phi}^{\gamma\delta}_{ij} \\
\widetilde{\Phi}^{\alpha\beta}_{ij} &amp; =
\frac{1}{4\pi\epsilon_0}
\frac{1}{\sqrt{\det \epsilon}}
\left(
    \frac
    { \widetilde{\epsilon}^{\alpha\beta} }
    {|\Delta_{ij}|_{\epsilon}^{3}}
    -3 \frac
    {\Delta_{ij}^{\alpha}\Delta_{ij}^{\beta}}
    {|\Delta_{ij}|_{\epsilon}^{5}}
\right)
\end{align}
\]</div>
<p>Here <span class="arithmatex">\(\boldsymbol{\epsilon}\)</span> is the dielectric tensor, <span class="arithmatex">\(\widetilde{\boldsymbol{\epsilon}}=\boldsymbol{\epsilon}^{-1}\)</span> its inverse and <span class="arithmatex">\(\Delta\)</span> realspace distances using the dielectric tensor as a metric:</p>
<div class="arithmatex">\[
\begin{align}
\mathbf{r}_{ij} &amp; = \mathbf{R}_{j}+\mathbf{\tau}_j-\mathbf{\tau}_i \\
\mathbf{\Delta}_{ij} &amp; =\widetilde{\boldsymbol{\epsilon}}\mathbf{r}_{ij} \\
|\Delta_{ij}|_{\epsilon} &amp; = \sqrt{\mathbf{\Delta}_{ij} \cdot \mathbf{r}_{ij}}
\end{align}
\]</div>
<p>This poses an issue when calculating the dynamical matrix: the interactions die off as <span class="arithmatex">\(~1/r^{3}\)</span> which makes it necessary to extend the sum over lattice vectors to infinity. This is remedied with the usual Ewald technique:</p>
<div class="arithmatex">\[
\widetilde{\mathbf{\Phi}}_{ij} (\mathbf{q})=
\widetilde{\mathbf{\Phi}}^\textrm{r}+\widetilde{\mathbf{\Phi}}^\textrm{q}+\widetilde{\mathbf{\Phi}}^\textrm{c}
\]</div>
<p>Dividing the sum into a realspace part, a reciprocal part and a connecting part. The realspace part is given by</p>
<div class="arithmatex">\[
\begin{align}
\widetilde{\mathbf{\Phi}}^\textrm{r}_{ij} &amp; =
-\frac{\Lambda^3}{4\pi\epsilon_0\sqrt{\det \epsilon}}
\sum_{\mathbf{R}}
\mathbf{H}(\Lambda \Delta_{ij},\Lambda|\Delta_{ij}|_{\epsilon})
e^{i \mathbf{q} \cdot \mathbf{R}} \\
%%
\frac{\partial \widetilde{\mathbf{\Phi}}^\textrm{r}_{ij}}{\partial q_\alpha}  &amp; =
-\frac{\Lambda^3}{4\pi\epsilon_0\sqrt{\det \epsilon}}
\sum_{\mathbf{R}}
iR_\alpha
\mathbf{H}(\Lambda \Delta_{ij},\Lambda|\Delta_{ij}|_{\epsilon})
e^{i \mathbf{q} \cdot \mathbf{R}}
\end{align}
\]</div>
<p>where</p>
<div class="arithmatex">\[
H_{\alpha\beta}(\mathbf{x},y) = \frac{x_{\alpha}x_{\beta} }{y^2}
\left[
\frac{3\,\textrm{erfc}\,y}{y^3}
+
\frac{2 e^{-y^2}}{\sqrt{\pi}}\left(\frac{3}{y^2}+2 \right)
\right]
-\widetilde{\epsilon}_{\alpha\beta}
\left[
\frac{\textrm{erfc}\,y}{y^3} + \frac{2 e^{-y}}{\sqrt{\pi} y^2 }
\right]\,.
\]</div>
<p>In reciprocal space we have</p>
<div class="arithmatex">\[
\begin{align}
%
% Not derivative
%
    \widetilde{\Phi}_\textrm{q}|_{ij}
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right) \\
%
% X-direction
%
    \frac{\partial}{\partial q_x} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^x_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha x}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    2K_x &amp; K_y &amp; K_z \\
    K_y &amp; 0 &amp; 0 \\
    K_z &amp; 0 &amp; 0
    \end{pmatrix} \\
%
% Y-direction
%
    \frac{\partial}{\partial q_y} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^y_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha y}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    0 &amp; K_x &amp; 0 \\
    K_y &amp; 2K_y &amp; K_z \\
    0 &amp; K_z &amp; 0
    \end{pmatrix}\\
%
% Z-direction
%
    \frac{\partial}{\partial q_z} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^z_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha z}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    0 &amp; 0 &amp; K_x \\
    0 &amp; 0 &amp; K_y \\
    K_z &amp; K_y &amp; 2K_z
    \end{pmatrix}
\end{align}
\]</div>
<p>where</p>
<div class="arithmatex">\[
\begin{align}
\chi_{ij}(\mathbf{K},\Lambda) &amp;  =
\frac{1}{\Omega\epsilon_0}
\frac{
\exp\left(i \mathbf{q} \cdot \mathbf{\tau}_{ij} \right)
\exp\left( -\frac{\|\mathbf{K}\|_{\epsilon}}{4\Lambda^2}  \right)
}
{\|\mathbf{K}\|_{\epsilon}} \\
%%
\|\mathbf{K}\|_{\epsilon} &amp; =\sum_{\alpha\beta}\epsilon_{\alpha\beta}K_\alpha K_\beta
\end{align}
\]</div>
<p>and finally a connecting part given by</p>
<div class="arithmatex">\[
\widetilde{\mathbf{\Phi}}_\textrm{c}|_{ij}=
\delta_{ij}
\frac{\Lambda^3}{3 \epsilon_0 \pi^{3/2} \sqrt{ \det \boldsymbol{\epsilon} } }
\widetilde{\boldsymbol{\epsilon}}
\]</div>
<p>@todo Add the Hessian w.r.t q here. It is so long.</p>
<p>This expression is invariant for any <span class="arithmatex">\(\Lambda&gt;0\)</span>, which is chosen to make the real and reciprocal sums converge with as few terms as possible. Note that the Born charges are factored out from <span class="arithmatex">\(\widetilde{\mathbf{\Phi}}\)</span>, and have to by multiplied in as described above. The derivatives with respect to <span class="arithmatex">\(q\)</span> are reproduced because they are useful when calculating the gradient of the dynamical matrix, needed when determining group velocities. In the long-wavelength limit, <span class="arithmatex">\(\mathbf{q}\rightarrow 0\)</span>, the dipole-dipole dynamical matrix reduces to the familiar non-analytical term:</p>
<div class="arithmatex">\[
\lim_{\mathbf{q}\rightarrow 0} \mathbf{\Phi}(\mathbf{q}) =
\frac{1}{\Omega\epsilon_0}
\frac{
\left(\mathbf{Z}_i\mathbf{q}\right) \otimes \left(\mathbf{Z}_j\mathbf{q}\right)
}{\mathbf{q}^T\boldsymbol{\epsilon}\mathbf{q}}
\]</div>
<p>This package implements three different ways of dealing with these long-ranged interactions. For historical reasons, the so-called mixed-space approach is available, but it should not be used except as an example of what not to do.</p>
<p>The technical issue is that the forces from a DFT calculation are not separated cleanly into "electrostatic longrange" and "everything else" components. The TDEP approach allows for two variants to separate this:</p>
<h5 id="separation-approach-1">Separation approach 1</h5>
<p>This is the approach proposed by Gonze &amp; Lee<sup id="fnref2:Gonze1997"><a class="footnote-ref" href="#fn:Gonze1997">6</a></sup>, only slightly adjusted since they assumed you start with reciprocal space dynamical matrices, whereas I start with realspace forceconstants. Algorithmically, it works like this:</p>
<ul>
<li>Define a <span class="arithmatex">\(N_a \times N_b \times N_c\)</span> suprecell, large enough that it snugly fits your realspace forceconstants.</li>
<li>Calculate the electrostatic dynamical matrices on a <span class="arithmatex">\(N_a \times N_b \times N_c\)</span> <span class="arithmatex">\(q\)</span>-mesh.</li>
<li>Inverse fourier transform the electrostatic dynamical matrices to realspace forceconstants:
$$
\mathbf{\Phi}^{\textrm{dd}}<em>{ij}(\mathbf{R}) =\frac{ \sqrt{m_i m_j} }{N_a N_b N_c} \sum</em>{\mathbf{q}}  \Phi^{\textrm{dd}}_{ij}(\mathbf{q}) e^{-i\mathbf{q} \cdot \mathbf{R}}
$$</li>
<li>Subtract these from the realspace forceconstants:
$$
\hat{\mathbf{\Phi}}<em>{ij}(\mathbf{R})=
\mathbf{\Phi}</em>{ij}(\mathbf{R})-
\mathbf{\Phi}^{\textrm{dd}}_{ij}(\mathbf{R})
$$</li>
<li>Calculate the dynamical matrix as a sum of the short- and long-ranged contributions:
$$
\mathbf{\Phi}<em>{ij}(\mathbf{q}) = \hat{\mathbf{\Phi}}</em>{ij}(\mathbf{R}) + \Phi^{\textrm{dd}}_{ij}(\mathbf{q})
$$</li>
</ul>
<p>At <span class="arithmatex">\(\mathbf{q}=0\)</span> the non-analytical contribution has to be added as well. This approach is reasonably robust, and works well in most materials. However, there are some aliasing contributions added since the realspace forceconstants are truncated by distance, and I propose a slight variation of this scheme:</p>
<h5 id="separation-approach-2">Separation approach 2</h5>
<p>This idea is similar in spirit, but does the separation into long- and short-ranged interactions at an earlier stage.</p>
<p>@todo Fill this in once published.</p>
<h5 id="mixed-space-approach">Mixed-space approach</h5>
<p>This is implemented for historical reasons and for comparison, but disabled by default. It should not be used for anything, it is incorrect, and doing it right cost nothing.</p>
<h4 id="other-dispersive-properties">Other dispersive properties</h4>
<p>We determine group velocities via the Hellman-Feynmann theorem:</p>
<div class="arithmatex">\[
\begin{equation}
    \nabla_{\mathbf{q}} \omega^2_s = \left\langle \epsilon_{\mathbf{q}s} \right| \nabla_{\mathbf{q}} \Phi(\mathbf{q})  \left| \epsilon_{\mathbf{q}s} \right\rangle
\end{equation}
\]</div>
<p>where the derivatives of the dynamical matrix are defined above, and</p>
<div class="arithmatex">\[
\begin{equation}
\mathbf{v}_{\mathbf{q}s} = \nabla_{\mathbf{q}} \omega_s(\mathbf{q})=
\frac{1}{2\omega_s} \nabla_{\mathbf{q}} \omega_s^2(\mathbf{q})
\end{equation}
\]</div>
<p>For degenerate modes this is ill-defined, we have to apply degenerate perturbation theory to resolve it. The practical procedure is as follows (this example is for a single component, but the same procedure works in general), first define</p>
<div class="arithmatex">\[
\begin{equation}
    h_{ij} =
    \left\langle \epsilon_{\mathbf{q}i} \right|
    \partial_{q_{\alpha}} \Phi(\mathbf{q})  \left| \epsilon_{\mathbf{q}j} \right\rangle
\end{equation}
\]</div>
<p>where the indices run over the degenerate subspace. The gradient is then</p>
<div class="arithmatex">\[
\begin{equation}
    \partial_{q_{\alpha}} \omega^{2}_{\mathbf{q}i} = \frac{1}{N} \sum_{i} \lambda_{i}
\end{equation}
\]</div>
<p>where <span class="arithmatex">\(\lambda_i\)</span> are the eigenvalues of <span class="arithmatex">\(h_{ij}\)</span>.</p>
<p>The Hessian with respect to <span class="arithmatex">\(q\)</span> is given via</p>
<div class="arithmatex">\[
\begin{align}
    \frac{\partial^2 \omega^{2}_{\lambda}}{\partial q_{\alpha} \partial q_{\beta}} &amp; =
    2\left\langle \epsilon_{\lambda} \right|
        \partial_{q_{\alpha}}\partial_{q_{\beta}}\Phi(\mathbf{q})
    \left| \epsilon_{\lambda} \right\rangle +
    \left\langle \epsilon_{\lambda} \right| \partial_{q_{\alpha}}\Phi(\mathbf{q}) \left| \partial_{q_{\beta}} \epsilon_{\lambda} \right\rangle
    +
    \left\langle \epsilon_{\lambda} \right| \partial_{q_{\beta}}\Phi(\mathbf{q}) \left| \partial_{q_{\alpha}} \epsilon_{\lambda} \right\rangle
    %
    \\
    %
    \frac{\partial^2 \omega_{\lambda}}{\partial q_{\alpha} \partial q_{\beta}} &amp; = \frac{1}{2\omega_{\lambda}}
    \left[
        \frac{\partial^2 \omega^{2}_{\lambda}}{\partial q_{\alpha} \partial q_{\beta}} -
        2 \frac{\partial \omega_{\lambda}}{\partial q_{\alpha}} \frac{\partial \omega_{\lambda}}{\partial q_{\beta}}
    \right]
\end{align}
\]</div>
<p>The mode Grüneisen parameters are a measure of the sensitivity of the vibrational frequencies to volume changes. They are given by</p>
<div class="arithmatex">\[
\begin{equation}
\gamma_{\mathbf{q}s}=-\frac{V}{\omega_{\mathbf{q}s}}\frac{\partial \omega_{\mathbf{q}s}}{\partial V}
\end{equation}
\]</div>
<p>where <span class="arithmatex">\(V\)</span> is the volume and <span class="arithmatex">\(\omega_{\mathbf{q}s}\)</span> is the frequency of mode <span class="arithmatex">\(s\)</span> at wave vector <span class="arithmatex">\(\mathbf{q}\)</span>. <span class="arithmatex">\(\gamma_{\mathbf{q}s}\)</span> can be obtained either by numerical differentiation of the phonon dispersion relations or from the third order force constants based on a perturbation approach:</p>
<div class="arithmatex">\[
\begin{equation}
\gamma_{\mathbf{q}s}=-\frac{1}{6\omega_{\mathbf{q}s}^2}\sum_{ijk\alpha\beta\gamma}
\frac{\epsilon^{i\alpha\dagger}_{\mathbf{q}s} \epsilon^{j\beta}_{\mathbf{q}s}}
{\sqrt{m_i m_j}}
r_k^\gamma \Phi_{ijk}^{\alpha\beta\gamma}e^{i\mathbf{q}\cdot\ \mathbf{r}_j}
\end{equation}
\]</div>
<p>Here <span class="arithmatex">\(\epsilon_{i\alpha}^{\mathbf{q}s}\)</span> is component <span class="arithmatex">\(\alpha\)</span> associated eigenvector <span class="arithmatex">\(\epsilon\)</span> for atom <span class="arithmatex">\(i\)</span>. <span class="arithmatex">\(m_i\)</span> is the mass of atom <span class="arithmatex">\(i\)</span>, and <span class="arithmatex">\(\mathbf{r}_i\)</span> is the vector locating its position.</p>
<h4 id="density-of-states">Density of states</h4>
<p>Using <code>--dos</code> or will calculate the phonon density of states, given by</p>
<div class="arithmatex">\[
g_s(\omega) = \frac{(2\pi)^3}{V} \int_{\mathrm{BZ}} \delta( \omega - \omega_{\mathbf{q}s}) d\mathbf{q}
\]</div>
<p>per mode <span class="arithmatex">\(s\)</span>, summing those up yields the total. The site projected density of states for site <span class="arithmatex">\(i\)</span> is given by</p>
<div class="arithmatex">\[
g_i(\omega) = \frac{(2\pi)^3}{V} \sum_{s} \int_{\mathrm{BZ}} \left|\epsilon^i_{\mathbf{q}s}\right|^2 \delta( \omega -  \omega_{\mathbf{q}s}) d\mathbf{q}
\]</div>
<p>that, also sums to the total density of states.</p>
<h3 id="input-files">Input files</h3>
<ul>
<li><a href="../../files/#infile.ucposcar">infile.ucposcar</a></li>
<li><a href="../extract_forceconstants/">infile.forceconstant</a></li>
</ul>
<p>Optional files:</p>
<ul>
<li><a href="../../files/#infile.qpoints_dispersion">infile.qpoints_dispersion</a> (to specify a path for the phonon dispersions)</li>
<li><a href="../extract_forceconstants/">infile.forceconstant_thirdorder</a> (for the Grüneisen parameter)</li>
</ul>
<h3 id="output-files">Output files</h3>
<p>Depending on options, the set of output files may differ. We start with the basic files that are written.</p>
<h4 id="outfiledispersion_relationshdf5"><code>outfile.dispersion_relations.hdf5</code></h4>
<p>This is a packed up format of all the data. Below is a short matlab snippet to plot parts of it, the hdf5 file is self-explanatory -- it contains all harmonic properties you can think of including some more.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fn</span><span class="p">=</span><span class="s">&#39;outfile.dispersion_relations.hdf5&#39;</span><span class="p">;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">x</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/q_values&#39;</span><span class="p">);</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">xtck</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/q_ticks&#39;</span><span class="p">);</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">xtckl</span><span class="p">=</span><span class="nb">strsplit</span><span class="p">(</span><span class="nb">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/&#39;</span><span class="p">,</span><span class="s">&#39;q_tick_labels&#39;</span><span class="p">));</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">y</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/frequencies&#39;</span><span class="p">);</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">frequnit</span><span class="p">=</span><span class="nb">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/frequencies&#39;</span><span class="p">,</span><span class="s">&#39;unit&#39;</span><span class="p">);</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="nb">clf</span><span class="p">;</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;xtick&#39;</span><span class="p">,</span><span class="n">xtck</span><span class="p">,</span><span class="s">&#39;xticklabel&#39;</span><span class="p">,</span><span class="n">xtckl</span><span class="p">,</span><span class="s">&#39;yminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">);</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">ylabel</span><span class="p">([</span><span class="s">&#39;Frequencies (&#39;</span><span class="w"> </span><span class="n">frequnit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>
</span></code></pre></div>
<p><a name="outfile.phonon_dos.hdf5"></a></p>
<h4 id="outfilephonon_doshdf5">'outfile.phonon_dos.hdf5'</h4>
<p>Contains the phonon density of states. The file is self-documented, below is a sample matlab snippet that plots it.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">Matlab</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">hej</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">fn</span><span class="p">=(</span><span class="s">&#39;outfile.phonon_dos.hdf5&#39;</span><span class="p">);</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">unique_atom_labels</span><span class="p">=</span><span class="nb">strsplit</span><span class="p">(</span><span class="nb">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/&#39;</span><span class="p">,</span><span class="s">&#39;unique_atom_labels&#39;</span><span class="p">));</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">energy_unit</span><span class="p">=</span><span class="nb">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/frequencies&#39;</span><span class="p">,</span><span class="s">&#39;unit&#39;</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">dos_unit</span><span class="p">=</span><span class="nb">h5readatt</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/dos&#39;</span><span class="p">,</span><span class="s">&#39;unit&#39;</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">omega</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/frequencies&#39;</span><span class="p">);</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="nb">dos</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/dos&#39;</span><span class="p">);</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">dos_per_mode</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/dos_per_mode&#39;</span><span class="p">);</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">dos_per_site</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/dos_per_site&#39;</span><span class="p">);</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">dos_per_unique_atom</span><span class="p">=</span><span class="nb">h5read</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="s">&#39;/dos_per_unique_atom&#39;</span><span class="p">);</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="nb">clf</span><span class="p">;</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w">    </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Phonon density of states&#39;</span><span class="p">)</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">dos_per_mode</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">        </span><span class="nb">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="nb">dos</span><span class="p">)</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;xminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;yminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">    </span><span class="nb">ylabel</span><span class="p">([</span><span class="s">&#39;Phonon density of states (&#39;</span><span class="w"> </span><span class="n">dos_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">    </span><span class="nb">xlabel</span><span class="p">([</span><span class="s">&#39;Frequency (&#39;</span><span class="w"> </span><span class="n">energy_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="w">    </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Phonon density of states per mode&#39;</span><span class="p">)</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">dos_per_mode</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="w">        </span><span class="nb">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="n">dos_per_mode</span><span class="p">(:,</span><span class="nb">i</span><span class="p">))</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;xminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;yminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="w">    </span><span class="nb">ylabel</span><span class="p">([</span><span class="s">&#39;Phonon density of states (&#39;</span><span class="w"> </span><span class="n">dos_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="w">    </span><span class="nb">xlabel</span><span class="p">([</span><span class="s">&#39;Frequency (&#39;</span><span class="w"> </span><span class="n">energy_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="w">    </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Phonon density of states per unique atom&#39;</span><span class="p">)</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="w">    </span><span class="n">y</span><span class="p">=</span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">omega</span><span class="p">));</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">dos_per_unique_atom</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="w">        </span><span class="n">y</span><span class="p">=</span><span class="n">y</span><span class="o">+</span><span class="n">dos_per_unique_atom</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="w">        </span><span class="nb">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="w">    </span><span class="n">l</span><span class="p">=</span><span class="nb">legend</span><span class="p">(</span><span class="n">unique_atom_labels</span><span class="p">);</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="s">&#39;edgecolor&#39;</span><span class="p">,</span><span class="s">&#39;none&#39;</span><span class="p">,</span><span class="s">&#39;location&#39;</span><span class="p">,</span><span class="s">&#39;northwest&#39;</span><span class="p">)</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;xminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;yminortick&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="w">    </span><span class="nb">ylabel</span><span class="p">([</span><span class="s">&#39;Phonon density of states (&#39;</span><span class="w"> </span><span class="n">dos_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a><span class="w">    </span><span class="nb">xlabel</span><span class="p">([</span><span class="s">&#39;Frequency (&#39;</span><span class="w"> </span><span class="n">energy_unit</span><span class="w"> </span><span class="s">&#39;)&#39;</span><span class="p">])</span>
</span></code></pre></div>
</div>
</div>
</div>
<h4 id="outfiledispersion_relations"><code>outfile.dispersion_relations</code></h4>
<p>This file contains a list of <span class="arithmatex">\(q\)</span> points (in 1/Å) according to the chosen path (default or specified by the user in <code>infile.qpoints_dispersions</code>) and the frequencies per mode (in the specified units via <code>--unit</code>) for the corresponding points.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( q_1 \qquad \omega_1 \qquad \omega_2 \qquad \ldots \qquad \omega_{3N_a} \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( q_2 \qquad \omega_1 \qquad \omega_2 \qquad \ldots \qquad \omega_{3N_a} \)    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Not that the first column is for plotting purposes only. It serves to ensure that each line segment is scaled properly, since each segment contains a fix number of points.</p>
<h4 id="outfilegroup_velocities"><code>outfile.group_velocities</code></h4>
<p>This file contains the norm of the group velocities as a function of q. Format is identical to that of the dispersions:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( q_1 \qquad |v_1| \qquad |v_2| \qquad \ldots \qquad |v_{3N_a}| \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( q_2 \qquad |v_1| \qquad |v_2| \qquad \ldots \qquad |v_{3N_a}| \) </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in km/s.</p>
<h4 id="outfilemode_gruneisen_parameters"><code>outfile.mode_gruneisen_parameters</code></h4>
<p>In case you used <code>--gruneisen</code>, the mode Grüneisen parameters will be written, in a format similar to the dispersions and group velocities:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ q_1 \qquad \gamma_1 \qquad \gamma_2 \qquad \ldots \qquad \gamma_{3N_a} $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ q_2 \qquad \gamma_1 \qquad \gamma_2 \qquad \ldots \qquad \gamma_{3N_a} $  </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in km/s.</p>
<p><a name="outfile.phonon_dos"></a></p>
<h4 id="outfilephonon_dos"><code>outfile.phonon_dos</code></h4>
<p>The first column is the list of frequencies and the second column in the density of states for this frequency, given in arbitrary units. Note that integrated density of states is normalized. One can calculate partial density of states (<code>--projected_dos_mode</code>); if the user specifies this option, an extra column will be added into the <code>outfile.phonon_dos</code> file for each type of atom. With <code>--projected_dos_site</code> the same thing happens but with an extra column for each atom in the unit cell.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ \omega_1 \qquad g(\omega_1) \qquad g_1(\omega_1) \qquad \ldots \qquad g_{N}(\omega_1) $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ \omega_2 \qquad g(\omega_2) \qquad g_1(\omega_2) \qquad \ldots \qquad g_{N}(\omega_2) $
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in states per energy unit, depending on choice of <code>--unit</code>. The total DOS normalizes to 3N independent of choice of unit.</p>
<h4 id="outfilefree_energy"><a name="outfile.free_energy"></a> <code>outfile.free_energy</code></h4>
<p>If one chooses the option <code>--temperature_range</code> or <code>--temperature</code> then this file will display a list of temperatures with corresponding temperatures, vibrational free energies, vibrational entropies and heat capacities.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ T_1 \qquad F_{\textrm{vib}} \qquad S_{\textrm{vib}} \qquad C_v $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ T_2 \qquad F_{\textrm{vib}} \qquad S_{\textrm{vib}} \qquad C_v $
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Temperature is given in K, <span class="arithmatex">\( F_{\textrm{vib}} \)</span> in eV/atom, <span class="arithmatex">\( S_\textrm{vib} \)</span> in eV/K/atom and heat capacity in eV/K/atom.</p>
<h4 id="outfilegrid_dispersionshdf5"><code>outfile.grid_dispersions.hdf5</code></h4>
<p>Using option <code>--dumpgrid</code> writes all phonon properties for a grid in the BZ to an hdf5 file, that is self-documented.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:Born1998">
<p>Born, M., &amp; Huang, K. (1964). Dynamical theory of crystal lattices. Oxford: Oxford University Press.&#160;<a class="footnote-backref" href="#fnref:Born1998" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:Hellman2011">
<p><a href="http://doi.org/10.1103/PhysRevB.84.180301">Hellman, O., Abrikosov, I. A., &amp; Simak, S. I. (2011). Lattice dynamics of anharmonic solids from first principles. Physical Review B, 84(18), 180301.</a>&#160;<a class="footnote-backref" href="#fnref:Hellman2011" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:Hellman2013a">
<p><a href="http://doi.org/10.1103/PhysRevB.88.144301">Hellman, O., &amp; Abrikosov, I. A. (2013). Temperature-dependent effective third-order interatomic force constants from first principles. Physical Review B, 88(14), 144301.</a>&#160;<a class="footnote-backref" href="#fnref:Hellman2013a" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:Hellman2013">
<p><a href="http://doi.org/10.1103/PhysRevB.87.104111">Hellman, O., Steneteg, P., Abrikosov, I. A., &amp; Simak, S. I. (2013). Temperature dependent effective potential method for accurate free energy calculations of solids. Physical Review B, 87(10), 104111.</a>&#160;<a class="footnote-backref" href="#fnref:Hellman2013" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:Gonze1994">
<p><a href="https://link.aps.org/doi/10.1103/PhysRevB.50.13035">Gonze, X., Charlier, J.-C., Allan, D. C. &amp; Teter, M. P. Interatomic force constants from first principles: The case of α-quartz. Phys. Rev. B 50, 13035–13038 (1994).</a>&#160;<a class="footnote-backref" href="#fnref:Gonze1994" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:Gonze1997">
<p><a href="http://link.aps.org/doi/10.1103/PhysRevB.55.10355">Gonze, X. &amp; Lee, C. Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory. Phys. Rev. B 55, 10355–10368 (1997).</a>&#160;<a class="footnote-backref" href="#fnref:Gonze1997" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:Gonze1997" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>